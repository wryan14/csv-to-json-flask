# CSV to JSON Converter

This Flask application converts CSV files to JSON data and exposes it through a REST API.

## Installation

1. Clone the repository: `git clone https://github.com/wryan14/csv-to-json-flask.git`
2. Install the required packages: `pip install -r requirements.txt`
3. Run the app: `python app.py`

## Usage

1. Open the app in your web browser at http://localhost:5000
2. Select a CSV file to upload and convert
3. Click the "Convert to JSON" button to generate the JSON data
4. View data in a table at `/api-table`

## File Manager

The File Manager is a feature of the CSV to JSON Converter web application that allows users to manage the JSON files that have been generated by the application. Users can view the list of uploaded JSON files and choose to delete them.

The File Manager consists of two endpoints in the Flask web application:

* `/list_files` endpoint: This endpoint returns a list of JSON files in the static folder as a JSON response. It uses the glob module to search for files in the static folder with the .json extension and returns a list of the filenames without the full path.

* `/delete_file` endpoint: This endpoint deletes a JSON file from the static folder. It takes the filename of the JSON file as a parameter in the request and uses the os module to check if the file exists in the static folder. If the file exists, it is deleted using the `os.remove()` method. The endpoint returns a JSON response indicating whether the file was deleted successfully or not.

The File Manager is accessed through a modal window in the application's header. When the user clicks the "File Manager" button, a modal window is displayed with the list of JSON files. The user can download a JSON file by clicking the download icon next to the file name, and can delete a JSON file by clicking the delete icon next to the file name.

The File Manager provides an easy way for users to manage the JSON files generated by the CSV to JSON Converter web application, without having to access the static folder directly.

## Search API

This API endpoint allows users to search for data in a JSON file that has been uploaded through the app. By default, the endpoint looks for a file called "data.json" in the app's static folder. However, users can specify a different filename by including it in the URL (e.g., "/api/data/myfile/search").

If the specified file exists, the endpoint loads its contents into memory and searches for data based on the provided search parameters (i.e., a search query, fields to search in, and keys to filter by). If no search parameters are provided, the entire dataset is returned. The endpoint then returns the search results as a JSON response. If the specified file does not exist, the endpoint returns an error message.

### API Endpoint

`/api/data/<filename>/search`

#### Parameters

- `q`: The search query (keyword) to filter the results (default: None).
- `field`: The field(s) to search in, separated by commas (default: None).
- `key`: The key to filter the results (default: None).

### Example Queries

1. Get all data without any filters:

`/api/data/<filename>/search`


2. Filter data based on a keyword:

`/api/data/<filename>/search?q=example`


3. Filter data based on a keyword in specific fields:

`/api/data/<filename>/search?q=example&field=title,description`


4. Filter data based on a key:

`/api/data/<filename>/search?key=example_key`


5. Filter data based on a keyword in specific fields and a key:

`/api/data/<filename>/search?q=example&field=title,description&key=example_key`

#### Example

Suppose we have a JSON data file called myfile.json containing information about products, including their name, price, and category:

```
[
    {
        "name": "Product A",
        "price": 10.0,
        "category": "Category 1"
    },
    {
        "name": "Product B",
        "price": 20.0,
        "category": "Category 2"
    },
    {
        "name": "Product C",
        "price": 30.0,
        "category": "Category 1"
    },
    {
        "name": "Product D",
        "price": 40.0,
        "category": "Category 2"
    }
]
```

We can use the search API to filter this data based on various criteria. For example:

To get all products in category 1:
`/api/data/myfile/search?field=category&q=Category%201`

This will return the following JSON response:


```
[
    {
        "name": "Product A",
        "price": 10.0,
        "category": "Category 1"
    },
    {
        "name": "Product C",
        "price": 30.0,
        "category": "Category 1"
    }
]
```

To get all products with a price greater than 20:
`/api/data/myfile/search?q=20&field=price`

This will return the following JSON response:

```
[
    {
        "name": "Product C",
        "price": 30.0,
        "category": "Category 1"
    },
    {
        "name": "Product D",
        "price": 40.0,
        "category": "Category 2"
    }
]
```

To get the names and prices of all products in category 2:
`/api/data/myfile/search?key=name,price&field=category&q=Category%202`

This will return the following JSON response:

```
[
    {
        "name": "Product B",
        "price": 20.0
    },
    {
        "name": "Product D",
        "price": 40.0
    }
]
```

### Upload Endpoint

`/upload`

This endpoint handles file uploads and converts them to JSON. It returns a JSON response indicating success or failure. Use this to bypass the interface. 

#### Parameters
- `file`: The file to be uploaded. The file must be in CSV format.
- `json_option` (optional): The option for handling the JSON file. Valid options are `"replace"` (replace existing file with uploaded data) and `"append"` (append uploaded data to existing file). The default is `"replace"`.

```
import requests

url = "http://localhost:5000/upload"

payload = {}
files = [
  ('file', open('data.csv','rb'))
]
headers= {}

response = requests.request("POST", url, headers=headers, data = payload, files = files)

print(response.text.encode('utf8'))
```

